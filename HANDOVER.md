# ã‚»ãƒƒã‚·ãƒ§ãƒ³å¼•ãç¶™ããƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

## ç¾åœ¨ã®çŠ¶æ³
- **ãƒ–ãƒ©ãƒ³ãƒ**: `feat/natural-language-search-tests`  
- **æœ€å¾Œã®æ­£å¸¸ã‚³ãƒŸãƒƒãƒˆ**: `bda9327` - æ­£è¦è¡¨ç¾ä¿®æ­£
- **ãƒ†ã‚¹ãƒˆçŠ¶æ³**: âœ… å…¨é€šéï¼ˆ46/46 passï¼‰

## å®Œäº†ã—ãŸä½œæ¥­
1. **æ­£è¦è¡¨ç¾ã‚¨ãƒ©ãƒ¼ä¿®æ­£** - FTS5æ¼”ç®—å­ã®æœ€å°é™å‡¦ç†ï¼ˆ`&@#`ã®ã¿ï¼‰ã«å¤‰æ›´
2. PR #21 ã®CodeRabbitã‚³ãƒ¡ãƒ³ãƒˆ1ä»¶ã«å›ç­”æ¸ˆã¿

## æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å¿…é ˆã‚¿ã‚¹ã‚¯

### ğŸš¨ BM25æ¼”ç®—å­ä¿®æ­£ï¼ˆæœ€å„ªå…ˆï¼‰
**CodeRabbitæŒ‡æ‘˜**: https://github.com/cozy-corner/fish-mcp-server/pull/21#discussion_r2154267957

**å•é¡Œ**: 
- ç¾åœ¨: `AND bm25(fish_search) > ?` (é–“é•ã„)
- ä¿®æ­£: `AND bm25(fish_search) < ?` (æ­£ã—ã„)
- ç†ç”±: SQLite FTS5ã®bm25()ã¯è² ã®å€¤ã‚’è¿”ã—ã€ã‚ˆã‚Šè² ã®å€¤ãŒé«˜ã„é–¢é€£æ€§ã‚’ç¤ºã™ãŸã‚

**ä¿®æ­£ç®‡æ‰€**: `src/services/search-service.ts:339`
```typescript
// ç¾åœ¨ï¼ˆé–“é•ã„ï¼‰
AND bm25(fish_search) > ?

// ä¿®æ­£å¾Œï¼ˆæ­£ã—ã„ï¼‰  
AND bm25(fish_search) < ?
```

**æ³¨æ„**: ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šé–¾å€¤ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãŒå³ã—ããªã‚Šã€ä¸€éƒ¨ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ãã®å ´åˆã¯ï¼š
1. é–¾å€¤ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ï¼ˆ`scoreThreshold`ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¿½åŠ ï¼‰
2. ãƒ†ã‚¹ãƒˆã§ç·©ã„é–¾å€¤ï¼ˆä¾‹: -100.0ï¼‰ã‚’ä½¿ç”¨

### ğŸ“ æ®‹ã‚Šã®CodeRabbitã‚³ãƒ¡ãƒ³ãƒˆå¯¾å¿œ
- ORDER BYå¥ã®ã‚³ãƒ¡ãƒ³ãƒˆçŸ›ç›¾ä¿®æ­£
- ãƒ†ã‚¹ãƒˆã®æ±ºå®šè«–æ€§å‘ä¸Š
- TODO.mdã‚¿ã‚¹ã‚¯çŠ¶æ³è¦‹ç›´ã—

## ä»Šå›ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å¤±æ•—ã‹ã‚‰å­¦ã‚“ã æ•™è¨“

### âŒ ã‚„ã£ã¦ã¯ã„ã‘ãªã„ã“ã¨
1. **`--no-verify` ã®ä½¿ç”¨** - CLAUDE.mdã§å³æ ¼ã«ç¦æ­¢ã•ã‚Œã¦ã„ã‚‹
2. **ãƒ†ã‚¹ãƒˆå¤±æ•—çŠ¶æ…‹ã§ã®ã‚³ãƒŸãƒƒãƒˆ** - ã©ã‚“ãªç†ç”±ãŒã‚ã£ã¦ã‚‚çµ¶å¯¾ã«ç¦æ­¢
3. **Force pushã—ãŸç†ç”±**: ä¸Šè¨˜2ã¤ã®é•åã§ãƒªãƒã‚¸ãƒˆãƒªçŠ¶æ…‹ãŒæ‚ªåŒ–ã—ãŸãŸã‚

### âœ… æ­£ã—ã„æ‰‹é †
1. ä¿®æ­£ â†’ ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ â†’ å…¨é€šéç¢ºèª â†’ ã‚³ãƒŸãƒƒãƒˆ â†’ ãƒ—ãƒƒã‚·ãƒ¥
2. ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ãŸã‚‰å¿…ãšä¿®æ­£ã—ã¦ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆ
3. `--no-verify` ã¯ä¸€åˆ‡ä½¿ç”¨ã—ãªã„

## ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
```bash
npm test        # å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npm run check-all  # lint + format + typecheck
```

## æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã®ç¢ºèªäº‹é …
1. ãƒ†ã‚¹ãƒˆãŒå…¨é€šéã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª: `npm test`
2. BM25æ¼”ç®—å­ä¿®æ­£ã‚’å®Ÿæ–½
3. ä¿®æ­£å¾Œã®ãƒ†ã‚¹ãƒˆçµæœã‚’ç¢ºèª
4. å…¨é€šéã‚’ç¢ºèªã—ã¦ã‹ã‚‰ã‚³ãƒŸãƒƒãƒˆãƒ»ãƒ—ãƒƒã‚·ãƒ¥

---
**é‡è¦**: ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å•é¡Œã®ã‚ã‚‹ã‚³ãƒŸãƒƒãƒˆã‚’å‰Šé™¤ã—ãŸå¾Œã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚æ¬¡ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã¯ã‚¯ãƒªãƒ¼ãƒ³ãªçŠ¶æ…‹ã‹ã‚‰å®‰å…¨ã«ä½œæ¥­ã‚’é€²ã‚ã¦ãã ã•ã„ã€‚